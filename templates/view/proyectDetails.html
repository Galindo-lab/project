{% extends 'layout/app/main.html' %}

{% block modals %}
  {% include 'layout/app/shared/Messages.html' %}
{% endblock %}

{% block sidebar %}
  <div class="my-2 flex-grow-1 overflow-auto">
    <div class="list-group list-group-flush bg-transparent">
      <button type="submit" name="goal_pk" value="" class="bg-transparent list-group-item list-group-item-action d-flex justify-content-between align-items-center">Todos</button>

      {% for goal in project.goal_set.all %}
        <a type="submit" href="{% url 'list_goals' pk=project.pk %}?goal_pk={{goal.pk}}" class="bg-transparent list-group-item list-group-item-action d-flex justify-content-between align-items-center">{{ goal.name }}</a>
      {% endfor %}
    </div>
  </div>
{% endblock %}

{% block main %}
  {% include 'layout/app/shared/TopNav.html' with projectTab='active' project=project title=project.name %}

  <div class="overflow-auto p-2" style="height: 100dvh; max-width: 600px;">


    <div class="mt-3">
      <h5>Detalles del proyecto</h5>
          <form method="post">
      {% csrf_token %}

      <div class="form-floating mb-3">
        <input type="text" class="form-control" name="name" value="Hospital infantil" maxlength="100" required id="id_name" placeholder="Nombre">
        <label for="{{ form.name.id_for_label }}">Nombre</label>
        {% if form.name.errors %}
          <div class="text-danger">{{ form.name.errors }}</div>
        {% endif %}
      </div>

      <div class="form-floating mb-3">
        <textarea class="form-control" name="description" id="id_description" placeholder="Descripción" style="height: 120px;" required>{{ form.description.value }}</textarea>
        <label for="{{ form.description.id_for_label }}">Descripción</label>
        {% if form.description.errors %}
          <div class="text-danger">{{ form.description.errors }}</div>
        {% endif %}
      </div>

      <button type="submit" class="btn btn-primary">Guardar Cambios</button>
    </form>
    </div>




 
    <div class="mt-5">
      <h5>Invitar usuario al proyecto</h5>
      <form method="post" action="{% url 'invitar_usuario' project.id %}">
        {% csrf_token %}
        <div class="form-group">
          <label for="email">Correo electrónico:</label>
          <input type="email" class="form-control" name="email" id="email" required>
        </div>
        <button type="submit" class="btn btn-success mt-2">Invitar</button>
      </form>

      <ul>
        {% for collaborator in project.collaborator_set.all %}
          <li>{{ collaborator.user.email }} - {{ collaborator.role }}</li>
        {% empty %}
          <li>No hay colaboradores aún.</li>
        {% endfor %}
      </ul>
    </div>
    


<a href="{% url 'export_project_csv' project.id %}" class="btn btn-secondary mt-3">Exportar a CSV</a>
<a href="{% url 'export_project_excel' project.id %}" class="btn btn-success mt-3">Exportar a Excel</a>

  </div>

  

  </div>


  
{% endblock %}
